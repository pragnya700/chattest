<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Responsive AI Chatbot â€” Gemini 2.5 Flash</title>
  <meta name="description" content="Responsive AI chatbot with Google Login integrated." />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    .chat-panel { backdrop-filter: blur(6px); }
    .bubble-user { border-bottom-right-radius: .5rem; }
    .bubble-ai { border-bottom-left-radius: .5rem; }
    .typing-dot { animation: bounce 1s infinite; }
    @keyframes bounce { 0%{ transform: translateY(0) } 50%{ transform: translateY(-6px) } 100%{ transform: translateY(0) } }
  </style>
</head>
<body class="antialiased bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

  <!-- Google Login Screen -->
  <div id="login-screen" class="fixed inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-900">
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-8 text-center max-w-sm w-full">
      <h1 class="text-2xl font-bold mb-4">Welcome to KittyAIChat</h1>
      <p class="mb-6 text-gray-600 dark:text-gray-300">Sign in with Google to start chatting with Gemini 2.5 Flash</p>
      <div id="g_id_onload"
        data-client_id="611704066903-0f5on12hnn2leafh413v2r5g6vtjc9ip.apps.googleusercontent.com"
        data-callback="handleCredentialResponse"
        data-auto_prompt="false">
      </div>
      <div class="flex justify-center">
        <div class="g_id_signin" data-type="standard" data-shape="rectangular" data-theme="outline" data-text="signin_with" data-size="large"></div>
      </div>
    </div>
  </div>

  <!-- Main Website (hidden until login) -->
  <div id="main-app" class="hidden">
    <header class="sticky top-0 bg-white/70 dark:bg-gray-800/70 backdrop-blur border-b border-gray-200 dark:border-gray-700">
      <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-9 h-9 rounded-lg bg-blue-600 text-white flex items-center justify-center font-bold">N</div>
          <div class="font-semibold">NovaChat (Gemini)</div>
        </div>
        <nav class="hidden sm:flex gap-4 text-sm opacity-80">
          <a href="#features">Features</a>
          <a href="#how">How</a>
          <a href="#faq">FAQ</a>
        </nav>
      </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-12">
      <section class="grid md:grid-cols-2 gap-8 items-center">
        <div>
          <h1 class="text-3xl sm:text-4xl font-extrabold">Responsive AI Chatbot â€” Powered by Gemini 2.5 Flash</h1>
          <p class="mt-4 text-gray-600 dark:text-gray-300">This chatbot is directly integrated with the Google Gemini 2.5 Flash API. Replace the API key in the script with your own to start chatting with real AI responses.</p>
          <div class="mt-6 flex gap-3">
            <button id="open-chat" class="px-4 py-2 bg-blue-600 text-white rounded-lg">Open Chat</button>
            <a href="#how" class="px-4 py-2 border rounded-lg">How it works</a>
          </div>
        </div>
        <div>
          <div class="rounded-xl border p-4 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-gray-800 dark:to-purple-900">
            <div class="text-sm uppercase opacity-70">Live Demo</div>
            <div class="mt-4 font-medium">Click the blue chat button at bottom-right or the Open Chat button.</div>
            <div class="mt-2 text-sm opacity-70">Try: "Explain quantum computing"</div>
          </div>
        </div>
      </section>
    </main>

    <footer class="py-8 border-t border-gray-200 dark:border-gray-700 text-center text-sm">Â© <script>document.write(new Date().getFullYear())</script> NovaChat â€” Gemini Demo</footer>

    <div id="chat-root"></div>
  </div>

  <script type="module">
    import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

    // ðŸ”‘ Replace with your Gemini API key
    const genAI = new GoogleGenerativeAI("YOUR_GEMINI_API_KEY");

    async function askGemini(prompt) {
      try {
        const model = genAI.getGenerativeModel({ model: "gemini-2.5-flash" });
        const result = await model.generateContent(prompt);
        return result.response.text();
      } catch (err) {
        console.error(err);
        return "[Error: Could not fetch response. Check API key or quota.]";
      }
    }

    // Google Login Handler
    window.handleCredentialResponse = (response) => {
      console.log("Google ID Token: ", response.credential);
      // Hide login, show app
      document.getElementById('login-screen').classList.add('hidden');
      document.getElementById('main-app').classList.remove('hidden');
    };

    // Chat UI (same as before)
    (function(){
      const store = {
        get(k, fallback){ try{ const r=localStorage.getItem(k); return r? JSON.parse(r): fallback }catch{ return fallback }},
        set(k,v){ try{ localStorage.setItem(k, JSON.stringify(v)) }catch{} }
      };

      const root = document.getElementById('chat-root');
      root.innerHTML = `
      <button id="chat-open" class="fixed bottom-5 right-5 z-50 bg-blue-600 text-white px-4 py-3 rounded-full shadow-lg">Chat</button>
      <div id="chat-panel" class="fixed inset-0 hidden z-50 flex items-end sm:items-center sm:justify-center">
        <div id="chat-backdrop" class="absolute inset-0 bg-black/30"></div>
        <div class="relative w-full sm:w-[36rem] max-h-[85vh] bg-white/90 dark:bg-gray-900/90 rounded-2xl border overflow-hidden chat-panel flex flex-col">
          <div class="flex items-center justify-between p-3 border-b">
            <div class="font-semibold">Gemini Assistant</div>
            <button id="close-chat" class="p-2 border rounded-lg">Close</button>
          </div>
          <div id="messages" class="p-4 overflow-y-auto flex-1 space-y-3"></div>
          <form id="composer" class="p-3 border-t flex gap-2">
            <textarea id="input" rows="1" class="flex-1 rounded-xl border px-3 py-2 resize-none text-gray-900 dark:text-gray-100 bg-white dark:bg-gray-800 placeholder-gray-400" placeholder="Ask Gemini..."></textarea>
            <button id="send" class="h-10 px-4 rounded-xl bg-blue-600 text-white">Send</button>
          </form>
        </div>
      </div>`;

      const openBtn = document.getElementById('chat-open');
      const panel = document.getElementById('chat-panel');
      const backdrop = document.getElementById('chat-backdrop');
      const closeBtn = document.getElementById('close-chat');
      const messagesEl = document.getElementById('messages');
      const inputEl = document.getElementById('input');
      const sendBtn = document.getElementById('send');

      let messages = store.get('chat:messages', [ { role: 'assistant', content: "Hi! I'm powered by Gemini 2.5 Flash. Ask me anything!" } ]);

      function renderMessages(){
        messagesEl.innerHTML = '';
        messages.forEach(m => {
          const wrapper = document.createElement('div');
          wrapper.className = m.role === 'user' ? 'text-right' : 'text-left';
          const box = document.createElement('div');
          box.className = 'inline-block max-w-[80%] px-3 py-2 rounded-lg text-sm ' + (m.role==='user' ? 'bg-blue-600 text-white' : 'bg-gray-200 dark:bg-gray-700');
          box.textContent = m.content;
          wrapper.appendChild(box);
          messagesEl.appendChild(wrapper);
        });
        messagesEl.scrollTop = messagesEl.scrollHeight;
      }

      async function sendMessage(text){
        if(!text) return;
        messages.push({ role: 'user', content: text });
        renderMessages();
        inputEl.value = '';
        messages.push({ role: 'assistant', content: 'Thinking...' });
        renderMessages();

        const reply = await askGemini(text);
        messages.pop();
        messages.push({ role: 'assistant', content: reply });
        store.set('chat:messages', messages);
        renderMessages();
      }

      sendBtn.addEventListener('click', (e)=>{ e.preventDefault(); sendMessage(inputEl.value.trim()); });
      inputEl.addEventListener('keydown',(e)=>{ if(e.key==='Enter' && !e.shiftKey){ e.preventDefault(); sendMessage(inputEl.value.trim()); }});
      openBtn.addEventListener('click', ()=> panel.classList.remove('hidden'));
      backdrop.addEventListener('click', ()=> panel.classList.add('hidden'));
      closeBtn.addEventListener('click', ()=> panel.classList.add('hidden'));

      renderMessages();
    })();
  </script>
</body>
</html>